#!/bin/bash

PACMAN=(
  "cliphist"
  "fcitx5"
  "fcitx5-configtool"
  "fcitx5-mozc"
  "grim"
  "hyprpaper"
  "hyprpicker"
  "libnotify"
  "man"
  "npm"
  "pacman-contrib"
  "pavucontrol"
  "pcmanfm"
  "pulseaudio"
  "pulseaudio-alsa"
  "pulseaudio-bluetooth"
  "ripgrep"
  "slurp"
  "swappy"
  "swaync"
  "unzip"
  "waybar"
  "wl-clipboard"
  "wofi"
)
YAY=(
  "nerd-fonts"
  "noto-fonts-cjk" 
  "noto-fonts-emoji" 
  "python-pywal16"
  "ttf-font-awesome"
  "ttf-hack-nerd"
  "ttf-icomoon-feather"
  "ttf-iosevka-nerd"
  "ttf-jetbrains-mono-nerd"
  "zen-browser-bin"
)

WALL_URL="https://w.wallhaven.cc/full"
WALLHAVEN=(
  "${WALL_URL}/8o/wallhaven-8opwv2.png" # Arisu
# "${WALL_URL}/2y/wallhaven-2yv5m6.png" # Arisu
  "${WALL_URL}/5g/wallhaven-5gyjw3.jpg" # Arisu
  "${WALL_URL}/9d/wallhaven-9d612x.png" # Mari
  "${WALL_URL}/rr/wallhaven-rrep8j.jpg" # Momoi
  "${WALL_URL}/p9/wallhaven-p9xqpm.jpg" # Momoi & Midori
  "${WALL_URL}/we/wallhaven-wel3l7.jpg" # Momoi & Midori
# "${WALL_URL}/l8/wallhaven-l86ykp.jpg" # Arisu, Yuzu, Momoi & Midori
)

DIR="$PWD"
CONF=(
  "${DIR}/.bashrc"
  "${DIR}/.gitconfig"
  "${DIR}/.config/"
  "${DIR}/.local/"
)

check_yay() {
  if [[ ! -f /usr/bin/yay ]]; then
    pushd /tmp/
    git clone https://aur.archlinux.org/yay.git
    pushd /tmp/yay/
    makepkg -si
    popd && popd
  fi
}

install_packages() {
  for package in "${PACMAN[@]}"; do
    sudo pacman -S --noconfirm "${package}"
  done

  for package in "${YAY[@]}"; do
    yay -S --noconfirm "${package}"
  done
}

wallpaper() {
  for url in "${WALLHAVEN[@]}"; do
    mkdir -p $HOME/Pictures/
    curl -O --output-dir $HOME/Pictures/ "${url}"
  done
}

copy_mod() {
  for copy in "${CONF[@]}"; do
    cp -r "${copy}" $HOME/
  done
  chmod +x $HOME/.local/bin/*
}

clone_neovim() {
  NEOVIM_DIR="$HOME/.config/nvim/"
  if [[ -z "$(ls -A "${NEOVIM_DIR}")" ]]; then
    git clone https://github.com/MuteSTEVE/nvim.git "${NEOVIM_DIR}"
  fi
}

main() {
  check_yay
  install_packages
  copy_mod
  wallpaper
  clone_neovim
}

main
